# 文件格式说明

本文档详细说明 Noveler 项目中使用的文件格式和 Front Matter 字段。

---

## 📄 章节文件格式

章节文件位于 `chapters/` 目录下，使用 Markdown 格式，带有 YAML Front Matter。

### 完整示例

```markdown
---
title: "第一章 初入江湖"
chapter: 1
wordCount: 3245
targetWords: 5000
characters: ["张无忌", "周芷若", "张三丰"]
locations: ["武当山", "客栈"]
tags: ["武侠", "成长", "拜师"]
created: "2025-11-19 10:00:00"
modified: "2025-12-10 15:30:00"
status: "初稿"
volume: "第一卷"
volumeChapter: 1
---

# 第一章 初入江湖

清晨的阳光透过窗棂洒在青石板上。

「师父，我想下山。」张无忌低声说道。

（这孩子终于长大了。）张三丰抚须而笑，眼中闪过一丝欣慰。
```

---

### Front Matter 字段说明

#### 基本信息

| 字段 | 类型 | 必填 | 说明 | 示例 |
|------|------|------|------|------|
| `title` | string | ✅ | 章节标题 | "第一章 初入江湖" |
| `chapter` | number | ✅ | 章节序号 | 1 |
| `wordCount` | number | ⚠️ | 字数统计（自动更新） | 3245 |
| `created` | datetime | ⚠️ | 创建时间（自动生成） | "2025-11-19 10:00:00" |
| `modified` | datetime | ⚠️ | 修改时间（自动更新） | "2025-12-10 15:30:00" |

> ⚠️ 标记的字段会被插件自动维护，建议不要手动修改

#### 进度管理

| 字段 | 类型 | 必填 | 说明 | 可选值 |
|------|------|------|------|--------|
| `status` | string | ❌ | 章节状态 | "草稿" \| "初稿" \| "修改中" \| "已完成" |
| `targetWords` | number | ❌ | 目标字数 | 5000 |

**状态说明**：
- **草稿** 📝 - 刚创建，还在构思或起草阶段
- **初稿** ✏️ - 完成第一遍写作
- **修改中** 🔧 - 正在润色、修改
- **已完成** ✅ - 最终完成状态

状态会影响侧边栏显示的图标。

#### 内容标注

| 字段 | 类型 | 必填 | 说明 | 示例 |
|------|------|------|------|------|
| `characters` | array | ❌ | 本章出场人物 | ["张无忌", "周芷若"] |
| `locations` | array | ❌ | 本章场景地点 | ["武当山", "客栈"] |
| `tags` | array | ❌ | 章节标签 | ["武侠", "成长"] |

**用途**：
- 帮助快速了解章节内容
- 便于后期检索和整理
- 人物名称会自动高亮显示

#### 分卷相关

| 字段 | 类型 | 必填 | 说明 | 示例 |
|------|------|------|------|------|
| `volume` | string | ❌ | 所属卷名称 | "第一卷" |
| `volumeChapter` | number | ❌ | 卷内章节号 | 1 |

**说明**：
- 仅在启用分卷功能时使用
- 插件会根据章节所在文件夹自动设置
- 支持按卷重置章节编号

---

## 👤 人物文件格式

人物文件位于 `characters/` 目录下，使用 Markdown 格式，带有 YAML Front Matter。

### 完整示例

```markdown
---
name: "张无忌"
gender: "男"
age: "20"
appearance: "眉清目秀，英俊潇洒"
personality: "善良仁慈，优柔寡断"
background: "武当派弟子，明教教主"
relationships: ["周芷若", "赵敏", "谢逊"]
abilities: ["九阳神功", "乾坤大挪移", "太极拳"]
importance: "主角"
firstAppearance: "第一章"
tags: ["主角", "武林盟主", "明教"]
created: "2025-11-19 10:00:00"
modified: "2025-12-10 15:30:00"
---

# 张无忌

## 基本信息

- **性别**：男
- **年龄**：20 岁
- **身份**：武当派弟子，明教教主
- **首次登场**：第一章 初入江湖

## 外貌描写

眉清目秀，英俊潇洒，身材修长。眼神清澈而坚定，给人以温和可亲之感。

## 性格特点

善良仁慈，心怀天下，但优柔寡断，面对感情尤其如此。为人正直，深受师长和朋友的信任。

## 背景故事

武当派张三丰的弟子，后成为明教教主。自幼父母双亡，在武当山长大...

## 武功绝学

- **九阳神功**：内力深��，刚猛无比
- **乾坤大挪移**：明教镇教之宝
- **太极拳**：以柔克刚，圆转如意

## 人际关系

- **师父**：张三丰
- **义父**：谢逊
- **恋人**：周芷若、赵敏
- **兄弟**：宋青书

## 成长历程

### 第一卷：武当岁月
...

### 第二卷：明教崛起
...
```

---

### Front Matter 字段说明

#### 基本信息

| 字段 | 类型 | 必填 | 说明 | 示例 |
|------|------|------|------|------|
| `name` | string | ✅ | 人物名称 | "张无忌" |
| `gender` | string | ❌ | 性别 | "男" \| "女" \| "其他" |
| `age` | string | ❌ | 年龄 | "20" \| "20-25" |
| `created` | datetime | ⚠️ | 创建时间（自动生成） | "2025-11-19 10:00:00" |
| `modified` | datetime | ⚠️ | 修改时间（自动更新） | "2025-12-10 15:30:00" |

#### 人物特征

| 字段 | 类型 | 必填 | 说明 | 示例 |
|------|------|------|------|------|
| `appearance` | string | ❌ | 外貌描写 | "眉清目秀，英俊潇洒" |
| `personality` | string | ❌ | 性格特点 | "善良仁慈，优柔寡断" |
| `background` | string | ❌ | 背景介绍 | "武当派弟子，明教教主" |

#### 关联信息

| 字段 | 类型 | 必填 | 说明 | 示例 |
|------|------|------|------|------|
| `relationships` | array | ❌ | 相关人物 | ["周芷若", "赵敏"] |
| `abilities` | array | ❌ | 技能/武功 | ["九阳神功", "乾坤大挪移"] |
| `tags` | array | ❌ | 标签 | ["主角", "武林盟主"] |

#### 分类信息

| 字段 | 类型 | 必填 | 说明 | 可选值 |
|------|------|------|------|--------|
| `importance` | string | ❌ | 人物重要性 | "主角" \| "重要配角" \| "次要配角" \| "路人" |
| `firstAppearance` | string | ❌ | 首次登场章节 | "第一章" |

**重要性说明**：
- **主角**：故事的核心人物
- **重要配角**：对剧情发展有重要影响的人物
- **次要配角**：有一定戏份但影响较小的人物
- **路人**：偶尔出场的龙套角色

影响 README 自动更新时的人物分类。

---

## 📁 项目配置文件

### novel.jsonc

项目根目录的 `novel.jsonc` 是插件的配置文件，使用 JSONC 格式（支持注释）。

详细配置说明请查看：[novel.jsonc 配置文档](novel-json配置说明.md)

---

## 💡 最佳实践

### 章节文件

1. **状态管理**：及时更新章节状态，便于跟踪进度
2. **目标字数**：设置合理的目标字数，帮助控制章节长度
3. **人物标注**：记录主要出场人物，方便后期检索
4. **地点标注**：标记场景地点，有助于把握故事节奏

### 人物文件

1. **重要性分类**：准确设置人物重要性，影响 README 展示
2. **首次登场**：记录首次登场章节，便于追溯人物引入
3. **关系网络**：详细记录人物关系，构建完整的角色关系网
4. **持续更新**：随着剧情发展，及时更新人物信息

---

## 🔧 字段的自动维护

### 自动更新的字段

以下字段会被插件自动维护，**建议不要手动修改**：

**章节文件**：
- `wordCount` - 保存时自动更新
- `modified` - 每次修改时自动更新
- `created` - 创建时生成（之后不再改变）

**人物文件**：
- `modified` - 每次修改时自动更新
- `created` - 创建时生成（之后不再改变）

### 手动维护的字段

以下字段需要手动设置和维护：

**章节文件**：
- `status` - 根据写作进度手动更新
- `characters` - 根据章节内容手动添加
- `locations` - 根据场景手动添加
- `tags` - 根据章节特点手动添加

**人物文件**：
- `importance` - 根据人物定位手动设置
- `relationships` - 随剧情发展手动维护
- `abilities` - 随人物成长手动更新

---

## ❓ 常见问题

**Q: Front Matter 中的字段顺序重要吗？**
A: 不重要。YAML 格式不要求字段顺序，可以按你喜欢的方式组织。

**Q: 可以添加自定义字段吗？**
A: 可以。插件不会删除未知字段，你可以添加任何自定义字段。

**Q: 字数统计不准确怎么办？**
A: 保存文件时会自动更新，如果仍不准确，可以删除 `wordCount` 字段后重新保存。

**Q: 为什么修改时间没有更新？**
A: 只��保存文件时才会更新 `modified` 字段。确保你保存了文件。

**Q: 章节状态可以自定义吗？**
A: 建议使用标准的四个状态（草稿/初稿/修改中/已完成），自定义状态可能无法正确显示图标。

**Q: 分卷相关字段什么时候使用？**
A: 仅在配置文件中启用分卷功能时使用。扁平结构不需要这些字段。

---

## 📚 相关文档

- [novel.jsonc 配置说明](novel-json配置说明.md) - 完整的配置选项
- [FAQ](FAQ.md) - 常见问题解答
- [CHANGELOG](../CHANGELOG.md) - 更新日志

---

**提示**：插件会尽量保持 Front Matter 的格式和注释，但建议定期备份重要文件。
